{"version":3,"sources":["components/timeline.js","components/legend.js","components/horizontal_bar_chart.js","components/map.js","containers/capital_improvements.js","App.js","serviceWorker.js","index.js"],"names":["Timeline","_Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","parseTimeLine","bind","assertThisInitialized","timelineScale","inherits","createClass","key","value","selectedYears","length","removeTimeline","timeLine","year","service","amount","i","data","dataPoint","c","parseInt","d3","selectAll","remove","that","timeScale","domain","range","serviceScale","timeData","d","timeRange","base","Math","E","improvementsScale","axis","scale","tickFormat","new_g","append","attr","enter","brush","extent","on","selection","map","invert","yearSelector","react_default","a","createElement","className","viewBox","preserveAspectRatio","Component","Legend","apply","arguments","createLegend","prevProps","prevState","changed","years","removeLegend","name","svg","colorMap","color","margin","text","colorScale","reduce","_step","_iterator","_createForOfIteratorHelper","district","split","s","n","done","Number","isNaN","pair","undefined","push","err","e","f","vs","String","regression","linear","equation","districtAmount","map_key","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","Citywide","financialData","districts","index","trim","yearlyData","x","g","parseYearData","amountAllocated","districtChanged","districtAllocated","min_max","colors","widthScale","axisBottom","ticks","HorizontalBarChart","createGraph","destroyGraph","exists","console","error","obj","deparmentAmount","deparmentKey","Parks and Recreation","General Government","Public Art","Public Works","Financial Services","Library","Fire & Safety Services","Safety and Inspections","Planning and Economic Development","Police","Fire","Office of Technology","department","sort","y","width","height","departmentSum","parseSum","departments","scaleLeft","scaleTop","clamp","axisLeft","axisTop","select","style","STARTLOC","Map","createMap","destroyMap","selectMap","updateMap","toggleShowChanges","clearYearSelection","state","portion","projection","showChange","osmMap","L","zoomControl","boxZoom","doubleClickZoom","zoomDelta","setView","tileLayer","attribution","minZoom","maxZoom","DISTZOOM","addTo","zoom_handler","updatePointPositions","invalidateSize","geoJSON","geodata","features","_","fillOpacity","onEachFeature","feature","layer","properties","bounds_calculated","getBounds","classed","latLngToLayerPoint","lat","latitude","lon","longitude","fitSize","splice","drag","pieces","sourceEvent","preventDefault","defaultPrevented","setState","unSelectMap","amt","flyTo","animate","duration","formatter","Intl","NumberFormat","currency","infobox","populateInfobox","pts","html","name2","title","selectPoint","format","description","create_ping","ping_pos","ping","circle","clicked_node","covered_points","filter","l","r","compute_pos","b","getBoundingClientRect","left","top","lp","rp","sqrt","pow","dist_between","size","districtPoints","parseDistrict","fitBounds","MINZOOM","map_createForOfIteratorHelper","districtData","parseFloat","_this2","id","timeline_Timeline","onClick","legend_Legend","horizontal_bar_chart_HorizontalBarChart","CapitalImprovement","loadData","district_map","capital_improvement_data","selectedYear","then","process","ready","map_Map","App","capital_improvements_CapitalImprovement","Boolean","window","location","hostname","match","ReactDOM","render","src_App","document","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.84cb654f.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3';\n\nexport default class Timeline extends Component {\n  constructor(props) {\n    super(props);\n    this.parseTimeLine = this.parseTimeLine.bind(this);\n    this.timelineScale = this.timelineScale.bind(this);\n  }\n\n  componentDidMount() {\n    this.timelineScale();\n  }\n\n  componentDidUpdate() {\n    if (this.props.selectedYears.length === 0) {\n      this.removeTimeline();\n      this.timelineScale();\n    }\n  }\n\n  parseTimeLine() {\n    let timeLine = [\n      {year:2004,service:'Community Facilities',amount:0},{year:2004,service:'Internal Service',amount:0},{year:2004,service:'Streets and Utilities',amount:0},{year:2004,service:'Residential and Economic Development',amount:0},{year:2005,service:'Community Facilities',amount:0},{year:2005,service:'Internal Service',amount:0},{year:2005,service:'Streets and Utilities',amount:0},{year:2005,service:'Residential and Economic Development',amount:0},{year:2006,service:'Community Facilities',amount:0},{year:2006,service:'Internal Service',amount:0},{year:2006,service:'Streets and Utilities',amount:0},{year:2006,service:'Residential and Economic Development',amount:0},{year:2007,service:'Community Facilities',amount:0},{year:2007,service:'Internal Service',amount:0},{year:2007,service:'Streets and Utilities',amount:0},{year:2007,service:'Residential and Economic Development',amount:0},{year:2008,service:'Community Facilities',amount:0},{year:2008,service:'Internal Service',amount:0},{year:2008,service:'Streets and Utilities',amount:0},{year:2008,service:'Residential and Economic Development',amount:0},{year:2009,service:'Community Facilities',amount:0},{year:2009,service:'Internal Service',amount:0},{year:2009,service:'Streets and Utilities',amount:0},{year:2010,service:'Residential and Economic Development',amount:0},{year:2010,service:'Community Facilities',amount:0},{year:2010,service:'Internal Service',amount:0},{year:2010,service:'Streets and Utilities',amount:0},{year:2011,service:'Residential and Economic Development',amount:0},{year:2011,service:'Community Facilities',amount:0},{year:2011,service:'Internal Service',amount:0},{year:2011,service:'Streets and Utilities',amount:0},{year:2011,service:'Residential and Economic Development',amount:0},{year:2012,service:'Community Facilities',amount:0},{year:2012,service:'Internal Service',amount:0},{year:2012,service:'Streets and Utilities',amount:0},{year:2012,service:'Residential and Economic Development',amount:0},{year:2013,service:'Community Facilities',amount:0},{year:2013,service:'Internal Service',amount:0},{year:2013,service:'Streets and Utilities',amount:0},{year:2013,service:'Residential and Economic Development',amount:0},{year:2014,service:'Community Facilities',amount:0},{year:2014,service:'Internal Service',amount:0},{year:2014,service:'Streets and Utilities',amount:0},{year:2014,service:'Residential and Economic Development',amount:0},{year:2015,service:'Community Facilities',amount:0},{year:2015,service:'Internal Service',amount:0},{year:2015,service:'Streets and Utilities',amount:0},{year:2015,service:'Residential and Economic Development',amount:0},{year:2016,service:'Community Facilities',amount:0},{year:2016,service:'Internal Service',amount:0},{year:2016,service:'Streets and Utilities',amount:0},{year:2016,service:'Residential and Economic Development',amount:0},{year:2017,service:'Community Facilities',amount:0},{year:2017,service:'Internal Service',amount:0},{year:2017,service:'Streets and Utilities',amount:0},{year:2017,service:'Residential and Economic Development',amount:0},{year:2018,service:'Community Facilities',amount:0},{year:2018,service:'Internal Service',amount:0},{year:2018,service:'Streets and Utilities',amount:0},{year:2018,service:'Residential and Economic Development',amount:0},{year:2019,service:'Community Facilities',amount:0},{year:2019,service:'Internal Service',amount:0},{year:2019,service:'Streets and Utilities',amount:0},{year:2019,service:'Residential and Economic Development',amount:0},\n    ];\n    for(let i = 0; i < this.props.data.length; i++) {\n      let dataPoint = this.props.data[i];\n      for (let c = 0; c < timeLine.length; c++) {\n        if (timeLine[c].year === parseInt(dataPoint.year) && timeLine[c].service === dataPoint.service) {\n          timeLine[c].amount += parseInt(dataPoint.amount);\n        }\n      }\n    }\n    return timeLine;\n  }\n\n  removeTimeline() {\n    const svg = d3.select(\".Timeline svg\");\n    svg.selectAll(\"g\").remove();\n  }\n\n  timelineScale() {\n    const that = this;\n    const timeScale = d3.scaleLinear().domain([2004,2019]).range([0, 600]);\n    const serviceScale =  d3.scaleOrdinal()\n      .domain(['Community Facilities', 'Internal Service', 'Streets and Utilities', 'Residential and Economic Development'])\n      .range([-15,-7.5,0,7.5])\n    const timeData = this.parseTimeLine();\n    const range = d3.extent(timeData, function(d){ return d.amount });\n    const timeRange = d3.scaleLog().base(Math.E).domain(range).range([0, 100]);\n    const improvementsScale = d3.scaleOrdinal()\n      .domain(['Community Facilities', 'Internal Service', 'Streets and Utilities', 'Residential and Economic Development'])\n      .range(['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c']);\n\n    const axis = d3.axisBottom().scale(timeScale).tickFormat(d3.format(\"d\"));\n    const svg = d3.select(\".Timeline svg\");\n    const new_g = svg.append(\"g\").attr(\"transform\", \"translate(155,0)\");\n    \n    new_g.append(\"g\").attr(\"transform\", \"translate(0, 90)\").call(axis);\n    new_g.selectAll('rect')\n      .data(timeData)\n    .enter().append(\"rect\")\n      .attr('x', function(d) { return timeScale(d.year) + serviceScale(d.service)})\n      .attr('y', function(d) { return (90-timeRange(d.amount)) })\n      .attr('width', 7.5)\n      .attr('height', function (d) { return timeRange(d.amount) })\n      .attr('fill', function(d) { return improvementsScale(d.service)});\n\n    const brush = d3.brushX().extent([[-20, 0], [620, 90]]).on(\"brush\", function() {\n        var extent = d3.event.selection.map(timeScale.invert, timeScale);\n        extent[0] = parseInt(extent[0]);\n        extent[1] = parseInt(extent[1]);\n        that.props.yearSelector(extent);\n    });\n\n    new_g.attr(\"class\", \"brush\").call(brush);\n  }\n\n  render() {\n    return (\n      <div className=\"Timeline\">\n       <svg viewBox=\"0 0 900 120\" preserveAspectRatio=\"xMidYMax meet\"/>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport regression from 'regression';\n\nexport default class Legend extends Component {\n  componentDidMount() {\n    this.createLegend();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.changed !== prevProps.changed || this.props.years !== prevProps.years) {\n      this.removeLegend();\n      this.createLegend();\n    }\n  }\n\n  removeLegend() {\n    const svg = d3.select(\".\" + this.props.name + \" svg\");\n    svg.selectAll(\"g\").remove();\n  }\n\n  createLegend() {\n    const svg = d3.select(\".\" + this.props.name + \" svg\");\n    const margin = 30;\n    const colorMap = [\n      {\n        name: \"Community Facilities\",\n        color: '#a6cee3'\n      },\n      {\n        name: \"Internal Service\",\n        color: '#1f78b4',\n      },\n      {\n        name: \"Streets and Utilities\",\n        color: '#b2df8a',        \n      },\n      {\n        name: \"Residential and Economic Development\",\n        color: '#33a02c'        \n      },\n    ];\n\n    svg.append(\"g\").selectAll(\"rect\")\n      .attr(\"transform\", \"translate(\" + margin * 2 + \",\"  + margin * 2 + \")\")\n      .data(colorMap)\n      .enter() \n      .append(\"rect\")\n      .attr(\"fill\", function(d,i) { return d.color; })\n      .attr(\"y\", (d,i) => margin * i + 10)\n      .attr(\"x\", margin * 1.2)\n      .attr(\"width\", 10)\n      .attr(\"height\", 10);\n  \n\n    svg.append(\"g\").selectAll(\"text\")\n      .attr(\"transform\", \"translate(\" + margin * 2 + \",\"  + margin * 2 + \")\")\n      .data(colorMap)\n      .enter() \n      .append(\"text\")\n      .text(function(d,i) { return d.name; })\n      .attr(\"class\", \"small\")\n      .attr(\"y\", (d,i) => margin * i + 19)\n      .attr(\"x\", margin * 1.2 + 20)\n    \n    this.colorScale(svg);\n  }\n\n  districtChanged(data) {\n    return data.reduce((a, c) => {\n      let dists = c.district.split(\",\");\n      for (let d of dists) {\n        let i = Number(d);\n        if (!isNaN(i) && Number(c.amount) > 0) {\n          let pair = [Number(c.year), Number(c.amount)];\n          if (a[i - 1] === undefined) {\n            a[i - 1] = [pair];\n          } else {\n            a[i - 1].push(pair);\n          }\n        }\n      }\n      return a;\n    }, []).map((vs, i) => {\n      return {\n        name: String(i + 1),\n        value: regression.linear(vs).equation[0]\n      };\n    });\n  }\n\n  districtAllocated(data) {\n    // TODO: Redo district amount.\n    let districtAmount = [\n      {name:\"1\",value:0},{name:\"2\",value:0},{name:\"3\",value:0},{name:\"4\",value:0},{name:\"5\",value:0},{name:\"6\",value:0},{name:\"7\",value:0},{name:\"8\",value:0},{name:\"9\",value:0},{name:\"10\",value:0},{name:\"11\",value:0},{name:\"12\",value:0},{name:\"13\",value:0},{name:\"14\",value:0},{name:\"15\",value:0},{name:\"16\",value:0},{name:\"17\",value:0},{name:\"Citywide\",value:0}\n    ]\n\n    const map_key = {\n      \"1\":0,\"2\":1,\"3\":2,\"4\":3,\"5\":4,\"6\":5,\"7\":6,\"8\":7,\"9\":8,\"10\":9,\"11\":10,\"12\":11,\"13\":12,\"14\":13,\"15\":14,\"16\":15,\"17\":16,\"Citywide\":17,\n    }\n\n    const financialData = data;\n    for (let i = 0; i < financialData.length; i++) {\n      let districts = financialData[i].district.split(\",\");\n      for (let c = 0; c < districts.length;  c++) {\n        if (!isNaN(parseInt(financialData[i].amount))) {\n          const index = map_key[districts[c].trim()];\n          if (index !== undefined) {\n            districtAmount[index].value += parseInt(financialData[i].amount)/districts.length;\n          }\n        }\n      }\n    }\n\n    return districtAmount;\n  }\n\n  parseYearData(years) {\n    if (years !== undefined && years.length !== 0) {\n      if (years[0] === 2003) {\n        years[0] = 2004;\n      }\n      if (years[0] === 2020) {\n        years[0] = 2019;\n      }\n      if (years[1] === 2003) {\n        years[1] = 2004;\n      }\n      if (years[1] === 2020) {\n        years[1] = 2019;\n      }\n\n      let i = years[0];\n      let yearlyData = [];\n      while (i <= years[1]) {\n        for (let x = 0; x < this.props.data.length; x++) {\n          if(parseInt(this.props.data[x].year) === i) {\n            yearlyData.push(this.props.data[x]);\n          }\n        }\n        i++;\n      }\n      return yearlyData;\n    }\n  }\n\n  colorScale(g) {\n    const widthArr = [0, 20, 40, 60, 80, 100, 120, 140, 160, 180];\n    const years = this.parseYearData(this.props.years); \n    const data = (years !== undefined) ? years : this.props.data;\n    const amountAllocated = this.props.changed ? this.districtChanged(data) : this.districtAllocated(data);\n    \n    const min_max = d3.extent(amountAllocated,\n      d => (d !== undefined && d.name !== \"Citywide\") ?\n      d.value : 0);\n    \n    if (!this.props.changed) {\n      min_max[0] = 0;\n    }\n\n    let colors = this.props.changed ? [\"#ca0020\", \"#f4a582\", \"#f7f7f7\", \"#92c5de\", \"#0571b0\"] : [\"#eff3ff\", \"#bdd7e7\", \"#6baed6\", \"#3182bd\", \"#08519c\"];\n    const widthScale = d3.scaleLinear().domain([0, 45, 90, 135, 180]).range(colors);\n\n    // Color Scale\n    const colorScale = d3.scaleLinear().domain(min_max).range([0, 210]);\n    const axisBottom = d3.axisBottom(colorScale).ticks(6, \"s\");\n\n    g.append(\"g\")\n    .attr(\"transform\", \"translate(\" + 45 + \",\"  + (210 - 2 * 25) + \")\")    \n    .attr(\"class\", \"small\")\n    .call(axisBottom);\n\n    g.append('g').selectAll(\"rect\")\n    .attr('class', 'cScale')\n      .data(widthArr)\n    .enter().append(\"rect\")\n    .attr(\"x\", function(d,i) { return 50 + d })\n    .attr(\"y\", 135)\n    .attr(\"width\", 20)\n    .attr(\"height\", 20)\n    .attr(\"fill\", function(d,i) {\n      return widthScale(d);\n    });\n  }\n\n  render() {\n    return (\n        <div className={this.props.name}>\n          <b className=\"center\"> Types of Services </b>\n          <svg viewBox=\"0 0 300 200\"></svg>\n        </div>\n    );\n  }\n}","    \nimport React, { Component } from \"react\";\nimport * as d3 from \"d3\";\n\n\nexport default class HorizontalBarChart extends Component {\n  constructor(props) {\n    super(props);\n    this.createGraph = this.createGraph.bind(this);\n    this.destroyGraph = this.destroyGraph.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.exists(this.props.data) && this.props.data.length !== 0) {\n      this.createGraph();\n    } else {\n      console.error(\"<HorizontalBoxPlot> Data inside of HorizontalBarChart is \" + this.props.data)\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.exists(this.props.data) && this.props.data.length !== 0) {\n      if (prevProps.data !== this.props.data || prevProps.years !== this.props.years || this.props.district !== prevProps.district) {\n        this.destroyGraph();\n        this.createGraph(this.props.district);\n      }\n    }  \n  }\n\n  componentWillUnmount() {\n    this.destroyGraph();\n  }\n\n  exists(obj) {\n    return obj !== undefined && obj !== null;\n  }\n\n  parseYearData(years) {\n    if (years !== undefined && years.length !== 0) {\n      if (years[0] === 2003) {\n        years[0] = 2004; \n      }\n      if (years[0] === 2020) {\n        years[0] = 2019;\n      }\n      if (years[1] === 2003) {\n        years[1] = 2004; \n      }\n      if (years[1] === 2020) {\n        years[1] = 2019;\n      }\n      \n      let i = years[0];\n      let yearlyData = [];\n      while (i <= years[1]) {\n        for (let x = 0; x < this.props.data.length; x++) {\n          if(parseInt(this.props.data[x].year) === i) {\n            yearlyData.push(this.props.data[x]);\n          }\n        }\n        i++;\n      }\n      return yearlyData;\n    }\n  }\n\n  parseSum() {\n    let deparmentAmount = [\n        {name:\"Parks and Recreation\",value:0},{name:\"General Government\",value:0},{name:\"Public Art\",value:0},{name:\"Public Works\",value:0},{name:\"Financial Services\",value:0},{name:\"Library\",value:0},{name:\"Fire & Safety Services\",value:0},{name:\"Safety and Inspections\",value:0},{name:\"Planning and Economic Development\",value:0},{name:\"Police\",value:0}, {name:\"Office of Technology\",value:0}\n    ]\n\n    let deparmentKey = { \n        \"Parks and Recreation\": 0,\n        \"General Government\": 1,\n        \"Public Art\": 2,\n        \"Public Works\": 3,\n        \"Financial Services\": 4,\n        \"Library\": 5,\n        \"Fire & Safety Services\": 6,\n        \"Safety and Inspections\": 7,\n        \"Planning and Economic Development\": 8,\n        \"Police\": 9,\n        \"Fire\": 6,\n        \"Office of Technology\": 10\n    }\n      const years = this.parseYearData(this.props.years);\n      const financialData = (years !== undefined) ? years : this.props.data;\n\n      for (let i = 0; i < financialData.length; i++) {\n        let department = deparmentKey[financialData[i].department];\n        if (department !== undefined && department !== null) {\n            if (!isNaN(parseInt(financialData[i].amount))) {\n              if (this.props.district !== undefined) {\n                const district = parseInt(this.props.district);\n                let districts = financialData[i].district.split(\",\");\n                for (let c = 0; c < districts.length;  c++) {\n                  let index = parseInt(districts[c].trim());\n                  if (index === district) {\n                    deparmentAmount[department].value += parseInt(financialData[i].amount)/districts.length;\n                  }\n                }\n              } else {\n                  deparmentAmount[department].value += parseInt(financialData[i].amount);\n              }\n            }\n          }\n        }\n\n      deparmentAmount.sort(function(x,y){\n        return d3.descending(x.value, y.value);\n      });\n\n      return deparmentAmount;\n  }\n\n  createGraph(district) {\n    const svg = d3.select(\".\" + this.props.name + \" svg\");\n    const width = this.props.width;\n    const height = this.props.height;\n    const margin = 30;\n\n    const departmentSum = this.parseSum(this.props.years, district);\n    const departments = departmentSum.map(function(d) {\n        return d.name;\n    });\n    // Scales\n    const scaleLeft = d3.scalePoint()\n      .domain(departments)\n      .range([margin, height - (3 * margin)]);\n\n    const scaleTop = d3.scaleLinear()\n      .domain(d3.extent(departmentSum, function(d) {\n        return d.value;\n      }))\n      .range([margin, width - (3 * margin)])\n      .clamp(true);\n\n    const colorScale = d3.scaleOrdinal()\n      .domain(['Public Works', 'Parks and Recreation', 'Planning and Economic Development', 'Police', 'Fire & Safety Services', 'Library', 'General Government', 'Safety and Inspections', 'Financial Services', 'Office of Technology', 'Public Art'])\n      .range(['#686c5e', '#b2df8a', '#33a02c', '#1f78b4', '#e31a1c', '#a6cee3', '#fdbf6f',  '#FF6700','#003366', '#ccc9c0', '#0f0f0f']);\n\n    // Axis\n    const axisLeft = d3.axisRight(scaleLeft);\n    const axisTop = d3.axisBottom(scaleTop).ticks(6, \"s\");\n    \n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin * 2 + \",\"  + margin / 2 + \")\")\n      .attr(\"class\", \"small\")\n      .call(axisLeft)\n      .call(g => g.select(\".domain\").remove())\n      .selectAll('text')\n      .attr('dy', '-0.3em')\n      .attr('dx', '-0.9em');\n\n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin + \",\"  + (height - 2 * margin) + \")\")    \n      .attr(\"class\", \"small\")\n      .call(axisTop);\n    \n    svg.append(\"g\")\n      .selectAll(\"g\")\n      .data(departmentSum)\n      .enter()\n      .append(\"rect\")\n      .attr(\"y\", (d,i) => margin / 2 +  scaleLeft(departmentSum[i].name))\n      .attr(\"x\", margin * 2)\n      .style(\"fill\", (d,i) =>  { return colorScale(d.name); })\n      .attr(\"width\", (d,i) => scaleTop(departmentSum[i].value) - margin)\n      .attr(\"height\", 10);\n    \n    svg.append(\"text\")\n      .text(\"Capital Improvements by Department\")\n      .attr(\"class\", \"small b\")\n      .attr(\"y\", 20)\n      .attr(\"x\", width / 4)\n  }\n\n  destroyGraph() {\n    const svg = d3.select(\".\" + this.props.name + \" svg\");\n    svg.selectAll(\"*\").remove();\n  }\n\n  render() {\n    return (\n      <div className={this.props.name}>\n        <svg viewBox={\"0 0 \" + this.props.width + \" \" + this.props.height } preserveAspectRatio=\"xMidYMax meet\"/>\n      </div>\n    );\n  }\n}","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport L from 'leaflet';\nimport regression from 'regression';\n\nimport Timeline from './timeline.js';\nimport Legend from './legend.js';\nimport HorizontalBarChart from './horizontal_bar_chart.js'\n\nconst MINZOOM = 13;\nconst DISTZOOM = MINZOOM + 1;\nconst MAXZOOM = DISTZOOM + 1;\nconst STARTLOC = [44.94, -93.10];\nconst FLYDURATION = 0.6;\n\nexport default class Map extends Component {\n  constructor(props) {\n    super(props);\n    this.createMap = this.createMap.bind(this);\n    this.destroyMap = this.destroyMap.bind(this);\n    this.selectMap = this.selectMap.bind(this);\n    this.updateMap = this.updateMap.bind(this);\n    this.districtAllocated = this.districtAllocated.bind(this);\n    this.toggleShowChanges = this.toggleShowChanges.bind(this);\n    this.clearYearSelection = this.clearYearSelection.bind(this);\n    this.state = {\n      portion: undefined,\n      projection: undefined,\n      showChange: false\n    }\n  }\n\n  // Type check for data types passed into map.js then create map if correct.\n  componentDidMount() {\n    let osmMap = L.map(\"osm-map\", {\n      //dragging: false,\n      zoomControl: false,\n      boxZoom: false,\n      doubleClickZoom: false,\n      //scrollWheelZoom: false,\n      zoomDelta: 0\n    }).setView(STARTLOC, 13);\n\n    /* TODO: Don't use OSM's tile server. It is not intended for this. */\n    L.tileLayer('https://a.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>.',\n      minZoom: MINZOOM,\n      maxZoom: MAXZOOM\n    }).addTo(osmMap);\n\n    let zoom_handler = function() { this.updatePointPositions(); }.bind(this);\n    osmMap.on(\"zoomend\", zoom_handler);\n    this.osmMap = osmMap;\n\n    this.createMap();\n    osmMap.invalidateSize();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.years.length === 0) {\n      this.updateMap();\n    } else {\n      if ((this.props.years[0] !== prevProps.years[0] || this.props.years[1] !== prevProps.years[1])) {\n        if (this.state.portion !== undefined) {\n          this.selectMap(this.state.portion, this.state.projection, this.props.years);\n        }\n\n        const years = this.parseYearData(this.props.years);\n        this.updateMap(years);\n      }\n    }\n  }\n\n  createMap(years) {\n    L.geoJSON(this.props.geodata.features, {\n      style: _ => ({fillOpacity: 1}),\n      onEachFeature: function(feature, layer) {\n        feature.properties.bounds_calculated = layer.getBounds();\n      }\n    }).addTo(this.osmMap);\n\n    d3.select(\"#osm-map\").selectAll(\"path\")\n      .classed(\"map-piece\", true)\n      .data(this.props.geodata.features);\n\n    this.updateMap(years);\n  }\n\n  updatePointPositions() {\n    let osmMap = this.osmMap;\n    d3.selectAll(\".map-point, .ping-marker\")\n      .attr(\"cx\", (d, i) =>\n            osmMap.latLngToLayerPoint({lat: d.latitude, lon: d.longitude}).x)\n      .attr(\"cy\", (d, i) =>\n            osmMap.latLngToLayerPoint({lat: d.latitude, lon: d.longitude}).y)\n      .attr(\"r\", 10);\n  }\n\n  updateMap(years) {\n    const that = this;\n    const projection = d3.geoMercator().fitSize([800, 800], this.props.geodata);\n    const data = (years !== undefined) ? years : this.props.data;\n    const amountAllocated = this.state.showChange ? this.districtChanged(data) : this.districtAllocated(data);\n\n    const min_max = d3.extent(amountAllocated,\n      d => (d !== undefined && d.name !== \"Citywide\") ?\n      d.value : 0);\n\n    if (!this.state.showChange) {\n      min_max[0] = 0;\n    } else {\n      min_max.splice(1, 0, 0);\n    }\n\n    let colors = this.state.showChange ? [\"#ca0020\", \"#f7f7f7\", \"#0571b0\"] : [\"#eff3ff\", \"#08519c\"];\n\n    const colorScale =\n          d3.scaleLinear().domain(min_max)\n          .range(colors);\n\n    let drag = d3.drag();\n    let pieces = d3.selectAll(\"#osm-map path\");\n    drag.on(\"end\", function() {\n      d3.event.sourceEvent.preventDefault();\n    });\n    pieces.call(drag);\n\n    pieces.on(\"click\", function (d, i) {\n      if (d3.event.defaultPrevented) {\n        return;\n      }\n\n      that.setState({ portion: d, projection:projection });\n      that.selectMap(d, projection, that.props.years);\n\n      d3.select(\"body\").on(\"keydown\", function() {\n        if (d3.event.key === \"Escape\") {\n          d3.select(\".infobox\")\n            .classed(\"infobox-hidden\", true);\n          that.unSelectMap();\n          that.setState({ portion: undefined, projection:undefined});\n          //that.clearYearSelection();\n          d3.select(\"body\").on(\"keydown\", null);\n        }\n      });\n    })\n      .attr('fill', function (d, i) {\n        let amt = amountAllocated[i];\n        return colorScale(amt !== undefined ? amt.value : 0);\n      });\n    this.osmMap.invalidateSize();\n  }\n\n  unSelectMap() {\n    d3.selectAll('.map-point, .ping-marker').remove();\n\n    this.osmMap.flyTo(STARTLOC, MINZOOM, {animate: true, duration: FLYDURATION});\n  }\n\n  // Set other paths to lower opacity.\n  selectMap(portion, projection, year) {\n    let that = this;\n    const improvementsScale = d3.scaleOrdinal()\n          .domain(['Community Facilities', 'Internal Service', 'Streets and Utilities', 'Residential and Economic Development'])\n          .range(['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c']);\n\n    const formatter = new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n    });\n\n    let infobox = d3.select(\".infobox\");\n    const populateInfobox = (infobox, pts) => {\n      infobox.html(\"\").classed(\"infobox-hidden\", false);\n      if (pts.length > 1) {\n        const infobox = d3.select(\".infobox\");\n        infobox.append('h2').html(portion !== undefined ? portion.properties.name2 : \"\");\n        infobox.append('ul').selectAll('li')\n          .data(pts.sort((f, s) => f.year < s.year))\n          .enter().append('li')\n          .html((d, i) => d.title + \" (\"+ d.year + \")\")\n          .on(\"click\", selectPoint())\n          .style(\"border-left-color\", function(d, i) {\n            return improvementsScale(d.service);\n          });\n      } else {\n        let d = pts[0];\n        if (d === undefined) {\n          return\n        }\n        infobox.html(\"<div class=\\\"infobox-dept\\\" style=\\\"border-top-color: \" + improvementsScale(d.service) + \"\\\">\"+ d.department + \"</div>\" +\n                     \"<div class=\\\"infobox-amount\\\">\" + formatter.format(d.amount) + \"</div>\" +\n                     \"<h2>\" + d.title + \" (\" + d.year + \")</h2>\" +\n                     \"<p>\" + d.description + \"</p>\")\n          .append(\"button\")\n          .html(\"back to district\")\n          .classed(\"return-button\", true)\n          .on(\"click\", function(d, i) {\n            that.selectMap(portion, projection, year);\n          });\n      }\n    };\n\n    let osmMap = this.osmMap;\n    const create_ping = function(d, i) {\n      /* TODO: this should only work if selected through the map, not\n       * from the list. */\n      const ping_pos = osmMap.latLngToLayerPoint({lat: d.latitude, lon: d.longitude});\n      const ping_duration = \"1.5s\";\n      const radius = 100;\n      const begin = \"0s\";\n\n      d3.selectAll(\".ping-marker\").remove();\n      let ping = d3.select(\"#osm-map svg\")\n          .selectAll(\".ping-marker\")\n          .data([d]).enter()\n          .append(\"circle\");\n\n      ping.attr(\"stroke\", \"black\")\n        .attr(\"stroke-width\", 2)\n        .attr(\"fill\", \"none\")\n        .attr(\"cx\", ping_pos.x)\n        .attr(\"cy\", ping_pos.y)\n        .classed(\"ping-marker\", true);\n\n      ping.append(\"animate\")\n        .attr(\"attributeName\", \"r\")\n        .attr(\"begin\", begin)\n        .attr(\"dur\", ping_duration)\n        .attr(\"repeatCount\", \"indefinite\")\n        .attr(\"values\", \"0; \" + radius)\n        .attr(\"keySplines\", \"0.165 0.84 0.44 1\")\n        .attr(\"keyTimes\", \"0; 1\")\n        .attr(\"calcMode\", \"spline\");\n\n      ping.append(\"animate\")\n        .attr(\"attributeName\", \"opacity\")\n        .attr(\"begin\", begin)\n        .attr(\"dur\", ping_duration)\n        .attr(\"repeatCount\", \"indefinite\")\n        .attr(\"values\", \"1; 0\");\n    };\n\n    const selectPoint = circle => function (d, i) {\n      const dist_between = (l, r) => {\n        const compute_pos = n => {\n          let b = n.getBoundingClientRect();\n          return {x: b.left, y: b.top};\n        };\n\n        let lp = compute_pos(l), rp = compute_pos(r);\n        return Math.sqrt((lp.x - rp.x) ** 2 + (lp.y - rp.y) ** 2);\n      };\n\n      d3.selectAll(\".ping-marker\").remove();\n      let clicked_node = this;\n\n      /* If I was to do this for real, I would use a proper spatial\n       * data structure instead of a functional for loop. */\n      if (circle) {\n        let covered_points = d3.selectAll('.map-point').filter(function() {\n          return (dist_between(clicked_node, this) < 21);\n        });\n\n        populateInfobox(infobox, covered_points.data());\n        if (covered_points.size() <= 1) {\n          create_ping(d, i);\n        }\n      } else {\n        populateInfobox(infobox, [d]);\n        create_ping(d, i);\n      }\n\n      osmMap.flyTo([d.latitude, d.longitude], MAXZOOM,\n                   {animate: true, duration: FLYDURATION});\n    };\n\n    const years = this.parseYearData(year);\n    const data = (years !== undefined) ? years : this.props.data;\n    const districtPoints = this.parseDistrict(data, portion);\n    const map = d3.select(\"#osm-map\");\n    let g = map.select('g');\n\n    d3.selectAll('.map-point, .ping-marker').remove();\n\n    populateInfobox(infobox, districtPoints);\n    g.selectAll('circle')\n        .data(districtPoints)\n        .enter().append('circle')\n        .classed(\"map-point\", true)\n        .attr(\"r\", 7.5)\n        .attr(\"fill\", function(d,_) {\n          return improvementsScale(d.service);\n        })\n        .on(\"click\", selectPoint(true));\n\n    this.osmMap.fitBounds(portion.properties.bounds_calculated,\n                          {maxZoom: DISTZOOM});\n    this.updatePointPositions();\n    this.osmMap.invalidateSize();\n  }\n\n  destroyMap() {\n    d3.selectAll(\"#osm-map path\").remove();\n  }\n\n  districtAllocated(data) {\n    // TODO: Redo district amount.\n    let districtAmount = [\n      {name:\"1\",value:0},{name:\"2\",value:0},{name:\"3\",value:0},{name:\"4\",value:0},{name:\"5\",value:0},{name:\"6\",value:0},{name:\"7\",value:0},{name:\"8\",value:0},{name:\"9\",value:0},{name:\"10\",value:0},{name:\"11\",value:0},{name:\"12\",value:0},{name:\"13\",value:0},{name:\"14\",value:0},{name:\"15\",value:0},{name:\"16\",value:0},{name:\"17\",value:0},{name:\"Citywide\",value:0}\n    ]\n\n    const map_key = {\n      \"1\":0,\"2\":1,\"3\":2,\"4\":3,\"5\":4,\"6\":5,\"7\":6,\"8\":7,\"9\":8,\"10\":9,\"11\":10,\"12\":11,\"13\":12,\"14\":13,\"15\":14,\"16\":15,\"17\":16,\"Citywide\":17,\n    }\n\n    const financialData = data;\n    for (let i = 0; i < financialData.length; i++) {\n      let districts = financialData[i].district.split(\",\");\n      for (let c = 0; c < districts.length;  c++) {\n        if (!isNaN(parseInt(financialData[i].amount))) {\n          const index = map_key[districts[c].trim()];\n          if (index !== undefined) {\n            districtAmount[index].value += parseInt(financialData[i].amount)/districts.length;\n          }\n        }\n      }\n    }\n\n    return districtAmount;\n  }\n\n  districtChanged(data) {\n    return data.reduce((a, c) => {\n      let dists = c.district.split(\",\");\n      for (let d of dists) {\n        let i = Number(d);\n        if (!isNaN(i) && Number(c.amount) > 0) {\n          let pair = [Number(c.year), Number(c.amount)];\n          if (a[i - 1] === undefined) {\n            a[i - 1] = [pair];\n          } else {\n            a[i - 1].push(pair);\n          }\n        }\n      }\n      return a;\n    }, []).map((vs, i) => {\n      return {\n        name: String(i + 1),\n        value: regression.linear(vs).equation[0]\n      };\n    });\n  }\n\n  parseDistrict(data, portion) {\n    let districtData = [];\n    for (let i = 0; i < data.length; i++) {\n      const latitude = parseFloat(data[i].latitude);\n      const longitude = parseFloat(data[i].longitude);\n      if (d3.geoContains(portion, [longitude, latitude])) {\n        districtData.push(data[i]);\n      }\n    }\n    return districtData;\n  }\n\n  parseYearData(years) {\n    if (years !== undefined && years.length !== 0) {\n      if (years[0] === 2003) {\n        years[0] = 2004;\n      }\n      if (years[0] === 2020) {\n        years[0] = 2019;\n      }\n      if (years[1] === 2003) {\n        years[1] = 2004;\n      }\n      if (years[1] === 2020) {\n        years[1] = 2019;\n      }\n\n      let i = years[0];\n      let yearlyData = [];\n      while (i <= years[1]) {\n        for (let x = 0; x < this.props.data.length; x++) {\n          if(parseInt(this.props.data[x].year) === i) {\n            yearlyData.push(this.props.data[x]);\n          }\n        }\n        i++;\n      }\n      return yearlyData;\n    }\n  }\n\n  toggleShowChanges() {\n    this.setState({ showChange: !this.state.showChange}, () => {\n      const years = this.parseYearData(this.props.years);\n      this.updateMap(years);\n    });\n  }\n\n  clearYearSelection() {\n    this.props.yearSelector([]);\n  }\n\n  render() {\n    return (\n      <div className=\"Map\">\n\t<div id=\"osm-map\"></div>\n        <Timeline data={this.props.data} yearSelector={this.props.yearSelector} selectedYears={this.props.years}/>\n        <div className=\"container-fluid hud-ui\">\n          <div className=\"row\">\n            <div className=\"col-3\">\n              <div className=\"row\">\n                <div className=\"col-6\">\n                  <button className=\"card\" onClick={this.toggleShowChanges}>\n                    Show {this.state.showChange ? \"total spending\" : \"change over time\"}\n                  </button>\n                </div>\n                <div className=\"col-6\">\n                  <button className=\"card\" onClick={this.clearYearSelection}>\n                    Clear timeline selection\n                  </button>\n                </div>\n              </div>\n              <div className=\"row\">\n                <div className=\"infobox infobox-hidden card\"></div>\n              </div>\n            </div>\n            <div className=\"col-6 spacer\">\n              <h1 className=\"app-title card\">Saint Paul Capital Improvements</h1>\n            </div>\n            <div className=\"col-3\">\n              <div className=\"card\">\n                <Legend name=\"legend\" data={this.props.data} years={this.props.years} changed={this.state.showChange}/>\n              </div>\n              <div className=\"card\">\n                <HorizontalBarChart name=\"barChart\" width=\"400\" height=\"400\" data={this.props.data} years={this.props.years} district={this.state.portion !== undefined ? this.state.portion.properties.district : undefined} />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport Map from '../components/map.js';\n\nexport default class CapitalImprovement extends Component {\n  constructor(props) {\n    super(props);\n    this.loadData = this.loadData.bind(this);\n    this.selectedYears = this.selectedYears.bind(this);\n    this.state = {\n        district_map: [],\n        capital_improvement_data: [],\n        selectedYear: []\n    }\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  componentDidUpdate() {\n\n  }\n\n  loadData() {\n    const that = this;\n    d3.csv(\"https://raw.githubusercontent.com/jackstanek/stpaul-census-tracts/master/Saint%20Paul%20CIB_Location%20Updates%2004.21.19.csv\").then(function(data) {\n      that.setState({\n        capital_improvement_data: data\n      });\n    });\n\n    d3.json(process.env.PUBLIC_URL + \"/stpaul_neighborhoods.geojson\").then(function(data) {\n      that.setState({\n        district_map: data\n      });\n    });\n  }\n\n  selectedYears(extent) {\n    this.setState({\n      selectedYear: extent\n    })\n  }\n\n  ready() {\n    return this.state.district_map.length === undefined\n      && this.state.capital_improvement_data.length !== 0;\n  }\n\n  render() {\n    return (\n      <div className=\"CapitalImprovement\">\n        { this.ready() ? (<Map geodata={this.state.district_map} data={this.state.capital_improvement_data} years={this.state.selectedYear} yearSelector={this.selectedYears}/>) : (<p className=\"loading\"> Loading Map Data...</p>) }\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport CapitalImprovement from './containers/capital_improvements.js';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <CapitalImprovement/>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
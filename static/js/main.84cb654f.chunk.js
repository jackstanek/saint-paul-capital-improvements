(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(e,t,a){e.exports=a(60)},60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(35),o=a.n(i),s=a(3),c=a(4),l=a(6),u=a(5),m=a(7),p=a(2),d=a(0),v=a(14),h=a.n(v),f=a(13),y=a.n(f),g=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).parseTimeLine=a.parseTimeLine.bind(Object(p.a)(Object(p.a)(a))),a.timelineScale=a.timelineScale.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.timelineScale()}},{key:"componentDidUpdate",value:function(){0===this.props.selectedYears.length&&(this.removeTimeline(),this.timelineScale())}},{key:"parseTimeLine",value:function(){for(var e=[{year:2004,service:"Community Facilities",amount:0},{year:2004,service:"Internal Service",amount:0},{year:2004,service:"Streets and Utilities",amount:0},{year:2004,service:"Residential and Economic Development",amount:0},{year:2005,service:"Community Facilities",amount:0},{year:2005,service:"Internal Service",amount:0},{year:2005,service:"Streets and Utilities",amount:0},{year:2005,service:"Residential and Economic Development",amount:0},{year:2006,service:"Community Facilities",amount:0},{year:2006,service:"Internal Service",amount:0},{year:2006,service:"Streets and Utilities",amount:0},{year:2006,service:"Residential and Economic Development",amount:0},{year:2007,service:"Community Facilities",amount:0},{year:2007,service:"Internal Service",amount:0},{year:2007,service:"Streets and Utilities",amount:0},{year:2007,service:"Residential and Economic Development",amount:0},{year:2008,service:"Community Facilities",amount:0},{year:2008,service:"Internal Service",amount:0},{year:2008,service:"Streets and Utilities",amount:0},{year:2008,service:"Residential and Economic Development",amount:0},{year:2009,service:"Community Facilities",amount:0},{year:2009,service:"Internal Service",amount:0},{year:2009,service:"Streets and Utilities",amount:0},{year:2010,service:"Residential and Economic Development",amount:0},{year:2010,service:"Community Facilities",amount:0},{year:2010,service:"Internal Service",amount:0},{year:2010,service:"Streets and Utilities",amount:0},{year:2011,service:"Residential and Economic Development",amount:0},{year:2011,service:"Community Facilities",amount:0},{year:2011,service:"Internal Service",amount:0},{year:2011,service:"Streets and Utilities",amount:0},{year:2011,service:"Residential and Economic Development",amount:0},{year:2012,service:"Community Facilities",amount:0},{year:2012,service:"Internal Service",amount:0},{year:2012,service:"Streets and Utilities",amount:0},{year:2012,service:"Residential and Economic Development",amount:0},{year:2013,service:"Community Facilities",amount:0},{year:2013,service:"Internal Service",amount:0},{year:2013,service:"Streets and Utilities",amount:0},{year:2013,service:"Residential and Economic Development",amount:0},{year:2014,service:"Community Facilities",amount:0},{year:2014,service:"Internal Service",amount:0},{year:2014,service:"Streets and Utilities",amount:0},{year:2014,service:"Residential and Economic Development",amount:0},{year:2015,service:"Community Facilities",amount:0},{year:2015,service:"Internal Service",amount:0},{year:2015,service:"Streets and Utilities",amount:0},{year:2015,service:"Residential and Economic Development",amount:0},{year:2016,service:"Community Facilities",amount:0},{year:2016,service:"Internal Service",amount:0},{year:2016,service:"Streets and Utilities",amount:0},{year:2016,service:"Residential and Economic Development",amount:0},{year:2017,service:"Community Facilities",amount:0},{year:2017,service:"Internal Service",amount:0},{year:2017,service:"Streets and Utilities",amount:0},{year:2017,service:"Residential and Economic Development",amount:0},{year:2018,service:"Community Facilities",amount:0},{year:2018,service:"Internal Service",amount:0},{year:2018,service:"Streets and Utilities",amount:0},{year:2018,service:"Residential and Economic Development",amount:0},{year:2019,service:"Community Facilities",amount:0},{year:2019,service:"Internal Service",amount:0},{year:2019,service:"Streets and Utilities",amount:0},{year:2019,service:"Residential and Economic Development",amount:0}],t=0;t<this.props.data.length;t++)for(var a=this.props.data[t],n=0;n<e.length;n++)e[n].year===parseInt(a.year)&&e[n].service===a.service&&(e[n].amount+=parseInt(a.amount));return e}},{key:"removeTimeline",value:function(){d.q(".Timeline svg").selectAll("g").remove()}},{key:"timelineScale",value:function(){var e=this,t=d.m().domain([2004,2019]).range([0,600]),a=d.o().domain(["Community Facilities","Internal Service","Streets and Utilities","Residential and Economic Development"]).range([-15,-7.5,0,7.5]),n=this.parseTimeLine(),r=d.h(n,function(e){return e.amount}),i=d.n().base(Math.E).domain(r).range([0,100]),o=d.o().domain(["Community Facilities","Internal Service","Streets and Utilities","Residential and Economic Development"]).range(["#a6cee3","#1f78b4","#b2df8a","#33a02c"]),s=d.a().scale(t).tickFormat(d.i("d")),c=d.q(".Timeline svg").append("g").attr("transform","translate(155,0)");c.append("g").attr("transform","translate(0, 90)").call(s),c.selectAll("rect").data(n).enter().append("rect").attr("x",function(e){return t(e.year)+a(e.service)}).attr("y",function(e){return 90-i(e.amount)}).attr("width",7.5).attr("height",function(e){return i(e.amount)}).attr("fill",function(e){return o(e.service)});var l=d.c().extent([[-20,0],[620,90]]).on("brush",function(){var a=d.g.selection.map(t.invert,t);a[0]=parseInt(a[0]),a[1]=parseInt(a[1]),e.props.yearSelector(a)});c.attr("class","brush").call(l)}},{key:"render",value:function(){return r.a.createElement("div",{className:"Timeline"},r.a.createElement("svg",{viewBox:"0 0 900 120",preserveAspectRatio:"xMidYMax meet"}))}}]),t}(n.Component);function b(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw i}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var k=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.createLegend()}},{key:"componentDidUpdate",value:function(e,t){this.props.changed===e.changed&&this.props.years===e.years||(this.removeLegend(),this.createLegend())}},{key:"removeLegend",value:function(){d.q("."+this.props.name+" svg").selectAll("g").remove()}},{key:"createLegend",value:function(){var e=d.q("."+this.props.name+" svg"),t=[{name:"Community Facilities",color:"#a6cee3"},{name:"Internal Service",color:"#1f78b4"},{name:"Streets and Utilities",color:"#b2df8a"},{name:"Residential and Economic Development",color:"#33a02c"}];e.append("g").selectAll("rect").attr("transform","translate(60,60)").data(t).enter().append("rect").attr("fill",function(e,t){return e.color}).attr("y",function(e,t){return 30*t+10}).attr("x",36).attr("width",10).attr("height",10),e.append("g").selectAll("text").attr("transform","translate(60,60)").data(t).enter().append("text").text(function(e,t){return e.name}).attr("class","small").attr("y",function(e,t){return 30*t+19}).attr("x",56),this.colorScale(e)}},{key:"districtChanged",value:function(e){return e.reduce(function(e,t){var a,n=b(t.district.split(","));try{for(n.s();!(a=n.n()).done;){var r=a.value,i=Number(r);if(!isNaN(i)&&Number(t.amount)>0){var o=[Number(t.year),Number(t.amount)];void 0===e[i-1]?e[i-1]=[o]:e[i-1].push(o)}}}catch(s){n.e(s)}finally{n.f()}return e},[]).map(function(e,t){return{name:String(t+1),value:y.a.linear(e).equation[0]}})}},{key:"districtAllocated",value:function(e){for(var t=[{name:"1",value:0},{name:"2",value:0},{name:"3",value:0},{name:"4",value:0},{name:"5",value:0},{name:"6",value:0},{name:"7",value:0},{name:"8",value:0},{name:"9",value:0},{name:"10",value:0},{name:"11",value:0},{name:"12",value:0},{name:"13",value:0},{name:"14",value:0},{name:"15",value:0},{name:"16",value:0},{name:"17",value:0},{name:"Citywide",value:0}],a={1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,10:9,11:10,12:11,13:12,14:13,15:14,16:15,17:16,Citywide:17},n=e,r=0;r<n.length;r++)for(var i=n[r].district.split(","),o=0;o<i.length;o++)if(!isNaN(parseInt(n[r].amount))){var s=a[i[o].trim()];void 0!==s&&(t[s].value+=parseInt(n[r].amount)/i.length)}return t}},{key:"parseYearData",value:function(e){if(void 0!==e&&0!==e.length){2003===e[0]&&(e[0]=2004),2020===e[0]&&(e[0]=2019),2003===e[1]&&(e[1]=2004),2020===e[1]&&(e[1]=2019);for(var t=e[0],a=[];t<=e[1];){for(var n=0;n<this.props.data.length;n++)parseInt(this.props.data[n].year)===t&&a.push(this.props.data[n]);t++}return a}}},{key:"colorScale",value:function(e){var t=this.parseYearData(this.props.years),a=void 0!==t?t:this.props.data,n=this.props.changed?this.districtChanged(a):this.districtAllocated(a),r=d.h(n,function(e){return void 0!==e&&"Citywide"!==e.name?e.value:0});this.props.changed||(r[0]=0);var i=this.props.changed?["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"]:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],o=d.m().domain([0,45,90,135,180]).range(i),s=d.m().domain(r).range([0,210]),c=d.a(s).ticks(6,"s");e.append("g").attr("transform","translate(45,160)").attr("class","small").call(c),e.append("g").selectAll("rect").attr("class","cScale").data([0,20,40,60,80,100,120,140,160,180]).enter().append("rect").attr("x",function(e,t){return 50+e}).attr("y",135).attr("width",20).attr("height",20).attr("fill",function(e,t){return o(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:this.props.name},r.a.createElement("b",{className:"center"}," Types of Services "),r.a.createElement("svg",{viewBox:"0 0 300 200"}))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).createGraph=a.createGraph.bind(Object(p.a)(Object(p.a)(a))),a.destroyGraph=a.destroyGraph.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.exists(this.props.data)&&0!==this.props.data.length?this.createGraph():console.error("<HorizontalBoxPlot> Data inside of HorizontalBarChart is "+this.props.data)}},{key:"componentDidUpdate",value:function(e,t){this.exists(this.props.data)&&0!==this.props.data.length&&(e.data===this.props.data&&e.years===this.props.years&&this.props.district===e.district||(this.destroyGraph(),this.createGraph(this.props.district)))}},{key:"componentWillUnmount",value:function(){this.destroyGraph()}},{key:"exists",value:function(e){return void 0!==e&&null!==e}},{key:"parseYearData",value:function(e){if(void 0!==e&&0!==e.length){2003===e[0]&&(e[0]=2004),2020===e[0]&&(e[0]=2019),2003===e[1]&&(e[1]=2004),2020===e[1]&&(e[1]=2019);for(var t=e[0],a=[];t<=e[1];){for(var n=0;n<this.props.data.length;n++)parseInt(this.props.data[n].year)===t&&a.push(this.props.data[n]);t++}return a}}},{key:"parseSum",value:function(){for(var e=[{name:"Parks and Recreation",value:0},{name:"General Government",value:0},{name:"Public Art",value:0},{name:"Public Works",value:0},{name:"Financial Services",value:0},{name:"Library",value:0},{name:"Fire & Safety Services",value:0},{name:"Safety and Inspections",value:0},{name:"Planning and Economic Development",value:0},{name:"Police",value:0},{name:"Office of Technology",value:0}],t={"Parks and Recreation":0,"General Government":1,"Public Art":2,"Public Works":3,"Financial Services":4,Library:5,"Fire & Safety Services":6,"Safety and Inspections":7,"Planning and Economic Development":8,Police:9,Fire:6,"Office of Technology":10},a=this.parseYearData(this.props.years),n=void 0!==a?a:this.props.data,r=0;r<n.length;r++){var i=t[n[r].department];if(void 0!==i&&null!==i&&!isNaN(parseInt(n[r].amount)))if(void 0!==this.props.district)for(var o=parseInt(this.props.district),s=n[r].district.split(","),c=0;c<s.length;c++){parseInt(s[c].trim())===o&&(e[i].value+=parseInt(n[r].amount)/s.length)}else e[i].value+=parseInt(n[r].amount)}return e.sort(function(e,t){return d.e(e.value,t.value)}),e}},{key:"createGraph",value:function(e){var t=d.q("."+this.props.name+" svg"),a=this.props.width,n=this.props.height,r=this.parseSum(this.props.years,e),i=r.map(function(e){return e.name}),o=d.p().domain(i).range([30,n-90]),s=d.m().domain(d.h(r,function(e){return e.value})).range([30,a-90]).clamp(!0),c=d.o().domain(["Public Works","Parks and Recreation","Planning and Economic Development","Police","Fire & Safety Services","Library","General Government","Safety and Inspections","Financial Services","Office of Technology","Public Art"]).range(["#686c5e","#b2df8a","#33a02c","#1f78b4","#e31a1c","#a6cee3","#fdbf6f","#FF6700","#003366","#ccc9c0","#0f0f0f"]),l=d.b(o),u=d.a(s).ticks(6,"s");t.append("g").attr("transform","translate(60,15)").attr("class","small").call(l).call(function(e){return e.select(".domain").remove()}).selectAll("text").attr("dy","-0.3em").attr("dx","-0.9em"),t.append("g").attr("transform","translate(30,"+(n-60)+")").attr("class","small").call(u),t.append("g").selectAll("g").data(r).enter().append("rect").attr("y",function(e,t){return 15+o(r[t].name)}).attr("x",60).style("fill",function(e,t){return c(e.name)}).attr("width",function(e,t){return s(r[t].value)-30}).attr("height",10),t.append("text").text("Capital Improvements by Department").attr("class","small b").attr("y",20).attr("x",a/4)}},{key:"destroyGraph",value:function(){d.q("."+this.props.name+" svg").selectAll("*").remove()}},{key:"render",value:function(){return r.a.createElement("div",{className:this.props.name},r.a.createElement("svg",{viewBox:"0 0 "+this.props.width+" "+this.props.height,preserveAspectRatio:"xMidYMax meet"}))}}]),t}(n.Component);function C(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return O(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw i}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var w=[44.94,-93.1],E=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).createMap=a.createMap.bind(Object(p.a)(Object(p.a)(a))),a.destroyMap=a.destroyMap.bind(Object(p.a)(Object(p.a)(a))),a.selectMap=a.selectMap.bind(Object(p.a)(Object(p.a)(a))),a.updateMap=a.updateMap.bind(Object(p.a)(Object(p.a)(a))),a.districtAllocated=a.districtAllocated.bind(Object(p.a)(Object(p.a)(a))),a.toggleShowChanges=a.toggleShowChanges.bind(Object(p.a)(Object(p.a)(a))),a.clearYearSelection=a.clearYearSelection.bind(Object(p.a)(Object(p.a)(a))),a.state={portion:void 0,projection:void 0,showChange:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=h.a.map("osm-map",{zoomControl:!1,boxZoom:!1,doubleClickZoom:!1,zoomDelta:0}).setView(w,13);h.a.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>.',minZoom:13,maxZoom:15}).addTo(e);var t=function(){this.updatePointPositions()}.bind(this);e.on("zoomend",t),this.osmMap=e,this.createMap(),e.invalidateSize()}},{key:"componentDidUpdate",value:function(e,t){if(0===this.props.years.length)this.updateMap();else if(this.props.years[0]!==e.years[0]||this.props.years[1]!==e.years[1]){void 0!==this.state.portion&&this.selectMap(this.state.portion,this.state.projection,this.props.years);var a=this.parseYearData(this.props.years);this.updateMap(a)}}},{key:"createMap",value:function(e){h.a.geoJSON(this.props.geodata.features,{style:function(e){return{fillOpacity:1}},onEachFeature:function(e,t){e.properties.bounds_calculated=t.getBounds()}}).addTo(this.osmMap),d.q("#osm-map").selectAll("path").classed("map-piece",!0).data(this.props.geodata.features),this.updateMap(e)}},{key:"updatePointPositions",value:function(){var e=this.osmMap;d.r(".map-point, .ping-marker").attr("cx",function(t,a){return e.latLngToLayerPoint({lat:t.latitude,lon:t.longitude}).x}).attr("cy",function(t,a){return e.latLngToLayerPoint({lat:t.latitude,lon:t.longitude}).y}).attr("r",10)}},{key:"updateMap",value:function(e){var t=this,a=d.k().fitSize([800,800],this.props.geodata),n=void 0!==e?e:this.props.data,r=this.state.showChange?this.districtChanged(n):this.districtAllocated(n),i=d.h(r,function(e){return void 0!==e&&"Citywide"!==e.name?e.value:0});this.state.showChange?i.splice(1,0,0):i[0]=0;var o=this.state.showChange?["#ca0020","#f7f7f7","#0571b0"]:["#eff3ff","#08519c"],s=d.m().domain(i).range(o),c=d.f(),l=d.r("#osm-map path");c.on("end",function(){d.g.sourceEvent.preventDefault()}),l.call(c),l.on("click",function(e,n){d.g.defaultPrevented||(t.setState({portion:e,projection:a}),t.selectMap(e,a,t.props.years),d.q("body").on("keydown",function(){"Escape"===d.g.key&&(d.q(".infobox").classed("infobox-hidden",!0),t.unSelectMap(),t.setState({portion:void 0,projection:void 0}),d.q("body").on("keydown",null))}))}).attr("fill",function(e,t){var a=r[t];return s(void 0!==a?a.value:0)}),this.osmMap.invalidateSize()}},{key:"unSelectMap",value:function(){d.r(".map-point, .ping-marker").remove(),this.osmMap.flyTo(w,13,{animate:!0,duration:.6})}},{key:"selectMap",value:function(e,t,a){var n=this,r=d.o().domain(["Community Facilities","Internal Service","Streets and Utilities","Residential and Economic Development"]).range(["#a6cee3","#1f78b4","#b2df8a","#33a02c"]),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),o=d.q(".infobox"),s=function(o,s){if(o.html("").classed("infobox-hidden",!1),s.length>1){var c=d.q(".infobox");c.append("h2").html(void 0!==e?e.properties.name2:""),c.append("ul").selectAll("li").data(s.sort(function(e,t){return e.year<t.year})).enter().append("li").html(function(e,t){return e.title+" ("+e.year+")"}).on("click",u()).style("border-left-color",function(e,t){return r(e.service)})}else{var l=s[0];if(void 0===l)return;o.html('<div class="infobox-dept" style="border-top-color: '+r(l.service)+'">'+l.department+'</div><div class="infobox-amount">'+i.format(l.amount)+"</div><h2>"+l.title+" ("+l.year+")</h2><p>"+l.description+"</p>").append("button").html("back to district").classed("return-button",!0).on("click",function(r,i){n.selectMap(e,t,a)})}},c=this.osmMap,l=function(e,t){var a=c.latLngToLayerPoint({lat:e.latitude,lon:e.longitude});d.r(".ping-marker").remove();var n=d.q("#osm-map svg").selectAll(".ping-marker").data([e]).enter().append("circle");n.attr("stroke","black").attr("stroke-width",2).attr("fill","none").attr("cx",a.x).attr("cy",a.y).classed("ping-marker",!0),n.append("animate").attr("attributeName","r").attr("begin","0s").attr("dur","1.5s").attr("repeatCount","indefinite").attr("values","0; 100").attr("keySplines","0.165 0.84 0.44 1").attr("keyTimes","0; 1").attr("calcMode","spline"),n.append("animate").attr("attributeName","opacity").attr("begin","0s").attr("dur","1.5s").attr("repeatCount","indefinite").attr("values","1; 0")},u=function(e){return function(t,a){d.r(".ping-marker").remove();var n=this;if(e){var r=d.r(".map-point").filter(function(){return function(e,t){var a=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}},n=a(e),r=a(t);return Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))}(n,this)<21});s(o,r.data()),r.size()<=1&&l(t)}else s(o,[t]),l(t);c.flyTo([t.latitude,t.longitude],15,{animate:!0,duration:.6})}},m=this.parseYearData(a),p=void 0!==m?m:this.props.data,v=this.parseDistrict(p,e),h=d.q("#osm-map").select("g");d.r(".map-point, .ping-marker").remove(),s(o,v),h.selectAll("circle").data(v).enter().append("circle").classed("map-point",!0).attr("r",7.5).attr("fill",function(e,t){return r(e.service)}).on("click",u(!0)),this.osmMap.fitBounds(e.properties.bounds_calculated,{maxZoom:14}),this.updatePointPositions(),this.osmMap.invalidateSize()}},{key:"destroyMap",value:function(){d.r("#osm-map path").remove()}},{key:"districtAllocated",value:function(e){for(var t=[{name:"1",value:0},{name:"2",value:0},{name:"3",value:0},{name:"4",value:0},{name:"5",value:0},{name:"6",value:0},{name:"7",value:0},{name:"8",value:0},{name:"9",value:0},{name:"10",value:0},{name:"11",value:0},{name:"12",value:0},{name:"13",value:0},{name:"14",value:0},{name:"15",value:0},{name:"16",value:0},{name:"17",value:0},{name:"Citywide",value:0}],a={1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,10:9,11:10,12:11,13:12,14:13,15:14,16:15,17:16,Citywide:17},n=e,r=0;r<n.length;r++)for(var i=n[r].district.split(","),o=0;o<i.length;o++)if(!isNaN(parseInt(n[r].amount))){var s=a[i[o].trim()];void 0!==s&&(t[s].value+=parseInt(n[r].amount)/i.length)}return t}},{key:"districtChanged",value:function(e){return e.reduce(function(e,t){var a,n=C(t.district.split(","));try{for(n.s();!(a=n.n()).done;){var r=a.value,i=Number(r);if(!isNaN(i)&&Number(t.amount)>0){var o=[Number(t.year),Number(t.amount)];void 0===e[i-1]?e[i-1]=[o]:e[i-1].push(o)}}}catch(s){n.e(s)}finally{n.f()}return e},[]).map(function(e,t){return{name:String(t+1),value:y.a.linear(e).equation[0]}})}},{key:"parseDistrict",value:function(e,t){for(var a=[],n=0;n<e.length;n++){var r=parseFloat(e[n].latitude),i=parseFloat(e[n].longitude);d.j(t,[i,r])&&a.push(e[n])}return a}},{key:"parseYearData",value:function(e){if(void 0!==e&&0!==e.length){2003===e[0]&&(e[0]=2004),2020===e[0]&&(e[0]=2019),2003===e[1]&&(e[1]=2004),2020===e[1]&&(e[1]=2019);for(var t=e[0],a=[];t<=e[1];){for(var n=0;n<this.props.data.length;n++)parseInt(this.props.data[n].year)===t&&a.push(this.props.data[n]);t++}return a}}},{key:"toggleShowChanges",value:function(){var e=this;this.setState({showChange:!this.state.showChange},function(){var t=e.parseYearData(e.props.years);e.updateMap(t)})}},{key:"clearYearSelection",value:function(){this.props.yearSelector([])}},{key:"render",value:function(){return r.a.createElement("div",{className:"Map"},r.a.createElement("div",{id:"osm-map"}),r.a.createElement(g,{data:this.props.data,yearSelector:this.props.yearSelector,selectedYears:this.props.years}),r.a.createElement("div",{className:"container-fluid hud-ui"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement("button",{className:"card",onClick:this.toggleShowChanges},"Show ",this.state.showChange?"total spending":"change over time")),r.a.createElement("div",{className:"col-6"},r.a.createElement("button",{className:"card",onClick:this.clearYearSelection},"Clear timeline selection"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"infobox infobox-hidden card"}))),r.a.createElement("div",{className:"col-6 spacer"},r.a.createElement("h1",{className:"app-title card"},"Saint Paul Capital Improvements")),r.a.createElement("div",{className:"col-3"},r.a.createElement("div",{className:"card"},r.a.createElement(k,{name:"legend",data:this.props.data,years:this.props.years,changed:this.state.showChange})),r.a.createElement("div",{className:"card"},r.a.createElement(j,{name:"barChart",width:"400",height:"400",data:this.props.data,years:this.props.years,district:void 0!==this.state.portion?this.state.portion.properties.district:void 0}))))))}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).loadData=a.loadData.bind(Object(p.a)(Object(p.a)(a))),a.selectedYears=a.selectedYears.bind(Object(p.a)(Object(p.a)(a))),a.state={district_map:[],capital_improvement_data:[],selectedYear:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(){}},{key:"loadData",value:function(){var e=this;d.d("https://raw.githubusercontent.com/jackstanek/stpaul-census-tracts/master/Saint%20Paul%20CIB_Location%20Updates%2004.21.19.csv").then(function(t){e.setState({capital_improvement_data:t})}),d.l("/saint-paul-capital-improvements/stpaul_neighborhoods.geojson").then(function(t){e.setState({district_map:t})})}},{key:"selectedYears",value:function(e){this.setState({selectedYear:e})}},{key:"ready",value:function(){return void 0===this.state.district_map.length&&0!==this.state.capital_improvement_data.length}},{key:"render",value:function(){return r.a.createElement("div",{className:"CapitalImprovement"},this.ready()?r.a.createElement(E,{geodata:this.state.district_map,data:this.state.capital_improvement_data,years:this.state.selectedYear,yearSelector:this.selectedYears}):r.a.createElement("p",{className:"loading"}," Loading Map Data..."))}}]),t}(n.Component),I=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(D,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[55,1,2]]]);
//# sourceMappingURL=main.84cb654f.chunk.js.map